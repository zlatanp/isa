<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="stylesheet" href="html/css/bootstrap.min.css" />
<link rel="stylesheet" href="html/css/bootstrap-theme.min.css" />
<link rel="stylesheet" href="html/css/homecss.css" />
<script src="html/js/jquery-3.1.0.min.js"></script>
<script src="html/js/jquery.min.js"></script>
<script src="html/js/bootstrap.js"></script>
<script src="html/js/bootstrap.min.js"></script>
<link href='http://fonts.googleapis.com/css?family=Cookie'
	rel='stylesheet' type='text/css'>


<script
	src="http://maps.google.com/maps/api/js?key=AIzaSyC9ocJcfr3p5BWAiPcmkb55y3wzGWPjJ14"></script>
<script type="text/javascript"
	src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
<script type="text/javascript"
	src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.1.0/sockjs.min.js"></script>
<script
	src="//netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>


<meta charset="ISO-8859-1">

<title>Restoran početna</title>

<script>
var ipadresa;
var grad;


	function onload(){
		var x = document.cookie;
		var delovi = x.split("=");
		var emailUlogovanog = delovi[1];
		
		if(emailUlogovanog.search("@")==-1){
			$('.navbar').hide();
			$('#glavniDiv').hide();
    	}
		
		if(emailUlogovanog.search("@")!=-1){
	     	$.ajax({ 
	             type: 'GET',
	             url: 'profile/dajNotifikaciju',
	             dataType: 'json',
	             data: {mojEmail : emailUlogovanog},
	     		 success: function(data){
	             			console.log(data);
	             			if(data == true)
	             			$('#notifikacija').append('<a onclick="notifikacija()" href="#"><img src="html/css/notif.png" style="width:24px;height:24px;" /> Zahtev za prijateljstvo </a>');
	            		}
	     	});
	     }
		
		
		$.getJSON('//api.ipify.org?format=jsonp&callback=?', function(data) {ipadresa = data.ip;
		$.getJSON('//freegeoip.net/json/'+ipadresa, function(data) {grad = data.city;});
		});
			


		
	}
</script>
</head>
<body onload="onload()">
	<nav class="navbar navbar-default">
		<div class="container-fluid">
			<!-- Brand and toggle get grouped for better mobile display -->
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed"
					data-toggle="collapse" data-target="#bs-example-navbar-collapse-1"
					aria-expanded="false">
					<span class="sr-only">Toggle navigation</span> <span
						class="icon-bar"></span> <span class="icon-bar"></span> <span
						class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="home.html">Restoran</a>
			</div>

			<!-- Collect the nav links, forms, and other content for toggling -->
			<div class="collapse navbar-collapse"
				id="bs-example-navbar-collapse-1">
				<ul class="nav navbar-nav">
					<li><a href="home.html">Početna<span class="sr-only">(current)</span></a></li>
					<li><a onclick="sviRestorani()" href="#">Svi restorani<span
							class="sr-only">(current)</span></a></li>
				</ul>
				<!--       <form class="navbar-form navbar-left"> -->
				<!--         <div class="form-group"> -->
				<!--           <input type="text" class="form-control" placeholder="Search Restaurants"> -->
				<!--         </div> -->
				<!--         <button type="submit" class="btn btn-default">Search</button> -->
				<!--       </form> -->
				<ul class="nav navbar-nav navbar-right">
					<li id="notifikacija"></li>
					<li><a onclick="profilKorisnika()" href="#">Moj profil</a></li>
					<li><a onclick="pocetnaFrends()" href="#">Prijatelji</a></li>
					<li><a onclick="izlogujSe()" href="#">Izloguj se</a></li>
				</ul>
			</div>
			<!-- /.navbar-collapse -->
		</div>
		<!-- /.container-fluid -->
	</nav>

	<script>
	function izlogujSe(){
		var x = document.cookie;
		var delovi = x.split("=");
		var emailUlogovanog = delovi[1];
		
		if(emailUlogovanog.search("@")!=-1){
			document.cookie =  "emailValue=" + "";
    		window.location.href="index.html";
    	}
	}

	
	function profilKorisnika(){
		document.getElementById('restoranProfil').style.display = 'none';
		document.getElementById('glavniDiv').style.display = 'block';
		var x = document.cookie;
		var delovi = x.split("=");
		var email = delovi[1];
		var ime;
		var prezime;
		
		dajSliku();
		
		if(email.search("@")!=-1){
	     	$.ajax({ 
	             type: 'GET',
	             url: 'profile/gost',
	             dataType: 'json',
	             data: {email : email},
	     		 success: function(data){
	             			console.log(data);
	             			document.getElementById("helloHeder").innerHTML = data.ime+" "+data.prezime;
	             			ime = data.ime;
	             			prezime = data.prezime;
	            		}
	     	});
	     	$('#glavniDiv').show();
	     	$('#leviDiv').show();
	     	$('#desniDiv').hide();
	     }
	}
	
	function basicDetails(){
		document.getElementById('restoranProfil').style.display = 'none';
		document.getElementById('glavniDiv').style.display = 'block';
		var x = document.cookie;
		var delovi = x.split("=");
		var email = delovi[1];
		$.ajax({ 
            type: 'GET',
            url: 'profile/gost',
            dataType: 'json',
            data: {email : email},
    		 success: function(data){
            			console.log(data);
            			$('#desniDiv').html('<h3><i>Osnovni podaci</i></h3><br><table id="tabela" border="1" ><tr><td>Ime: </td><td><input style="border:none" readonly type="text" id="FirstName" value="'+data.ime+'"></td></tr><tr><td>Prezime: </td><td><input readonly style="border:none" type="text" id="LastName" value="'+data.prezime+'"></td></tr><tr><td>Email adresa: </td><td><input readonly style="border:none" type="text" id="Email" value="'+data.email+'"></td></tr></table><br><div id="zaUpload"></div><br></br><button id="editDetails" onclick="editDetails()">Izmeni osnovne podatke</button><button id="saveDetails" onclick="return saveDetails()" style = "display: none">Sačuvaj</button>&nbsp;<button id="cancelDetails" onclick="basicDetails()" style = "display: none">Odustani od izmena</button><br></br>');
            			$('#desniDiv').show();	
    		 }
    	});
		
		
	}
	
	function editDetails(){
		document.getElementById('restoranProfil').style.display = 'none';
		document.getElementById('glavniDiv').style.display = 'block';
		var x = document.cookie;
		var delovi = x.split("=");
		var email = delovi[1];
		
		
		
		$('#editDetails').hide();
		$('#saveDetails').show();
		$('#cancelDetails').show();
		$('#tabela').append('<tr><td>Nova šifra: </td><td><input style="border:none" type="password" id="password"></td></tr><tr><td>Ponovljena nova šifra: </td><td><input style="border:none" type="password" id="password1"></td></tr>');
		$('#zaUpload').html('<form method="POST" action="picture/upload/'+email+'" enctype="multipart/form-data">Dodaj novu profilnu sliku: <br><input type="file" id="file" name="file"><input type="hidden" name="email" value="'+email+'"><br><input onclick="return proveraVelicine()" type="submit" value="Učitaj"></form>');
		
		$('#FirstName').attr('readonly', false);
		$('#LastName').attr('readonly', false);
		
	}
	
	function proveraVelicine(){
		 if (!window.FileReader) {
		        alert("Pretraživač ne omogućava učitavanje slika!");
		        return false;
		    }
		 
		 input = document.getElementById('file');
		 file = input.files[0];
		 
		 if(!file){
		       alert("Morate izabrati sliku pre pritiskanja 'Učitaj'");
		       return false;
		 }else if(file.size>999998){
			 alert("Maksimalna veličina slike mora biti manja od 1MB!");
			 return false;
		 }else{
			 return true;
		 }
		 
	}
		 

	
	function saveDetails(){
		document.getElementById('restoranProfil').style.display = 'none';
		document.getElementById('glavniDiv').style.display = 'block';
		var i = document.getElementById('FirstName');
		var ime = i.value;
		var j = document.getElementById('LastName');
		var prezime = j.value;
		var m = document.getElementById('Email');
		var email = m.value;
		var k = document.getElementById('password');
		var password = k.value;
		var l = document.getElementById('password1');
		var password1 = l.value;
		
		if(ime == "" || prezime == "" || email == "" || password == "" || password1 == ""){
			alert("Morate uneti sva polja!");
    		return false;
		}else{
			if(password.length <8){
        		alert("Šifra mora biti duža od 8 karaktera!")
        		return false;
        	}
        	if(password.length > 30){
        		alert("Šifra mora da bude između 8-30 karaktera!")
        		return false;
        	}
        	
        	if(password != password1){
        		alert("Nova šifra i ponovljena se ne podudaraju!")
        		return false;
        	}
        	
        	$.ajax({ 
                type: 'GET',
                url: 'profile/edit/',
                dataType: 'json',
                data: {ime : ime, prezime : prezime, email : email, password : password, password1 : password1},
        		 success: function(data){
                			console.log(data);
                			location.reload();
                			return true;
        		 }
        	});
        	
        	return true;
        	
		}
		
		
		
	}
	
	function dajSliku(){
		document.getElementById('restoranProfil').style.display = 'none';
		document.getElementById('glavniDiv').style.display = 'block';
		var x = document.cookie;
		var delovi = x.split("=");
		var email = delovi[1];
		
		 $.ajax({
			    url :'picture/dajSliku/'+email,
			    type: "GET",
			    contentType: "image/jpg",
			    dataType: "text",
			    success: function(data) { 
			            $("#mestoZaSliku").html('<img src="data:image/jpg;base64,' + data + '" style="width:260px;height:260px;" />');
			        }
			    });
			}
	
	
</script>
	<div class="container" style="display: none; background-color: #E8E8E8"
		id="glavniDiv">
		<h1 id="helloHeder"></h1>
		<div class="row">
			<div class="col-sm-3" id="leviDiv">
				<div id="mestoZaSliku"></div>
				<br> <br> <a href="#" onclick="basicDetails()">Osnovni
					podaci</a><br> <a href="#" onclick="friends()">Prijatelji</a>
			</div>
			<div class="col-sm-9" id="desniDiv"></div>
		</div>

	</div>
	
	<div id="restoranProfil" style="display: none;">
	
	<div id="logoDiv">
		<h2 id="logo"></h2>
		<h3 id="opis"></h3>
	</div>


	<div class="container hideMe col-lg-10" id="divInfo">
		<table id="tableInfo">
			<tr>
				<td>
				   <table>
					<tr>
						<th>Tip:</th>
						<td class="td" id="tipTD"></td>
					</tr>
					<tr>
						<th>Adresa:</th>
						<td class="td" id="adrTD"></td>
					</tr>
					<tr>
						<th>Grad:</th>
						<td class="td" id="gradTD"></td>
					</tr>
					<tr>
						<th>Telefon:</th>
						<td class="td" id="telTD"></td>
					</tr>
					<tr>
						<th>E-mail:</th>
						<td class="td" id="emailTD"></td>
					</tr>
					<tr>
						<th>Radno vreme:</th>
						<td class="td" id="radnoVremeTD"></td>
					</tr>
				</table>
				</td>
				<td>&nbsp;</td>
				<td style="border:solid">
					<img id="slikaRestImg" src="/slike/restorani/restoran.jpg" style="width:250px;height:100"/>
				</td>
			</tr>
			<tr>
			<td>&nbsp;</td>
			</tr>
			<tr>
				<td>
					<button class="btn btn-success col-lg-offset-5">Pogledaj jelovnik</button>
					
				</td>
				<td>
				<button class="btn btn-success col-lg-offset-5">Pogledaj kartu pića</button>
					
				</td>
				<td>
					<button class="btn btn-success col-lg-offset-5">Rezerviši</button>
					
				</td>
			</tr>
		</table>
		<div class="col-md-8" style="padding: 10px">
			<div id="dajmapumesto" style="height: 200px;"></div>
		</div>
	</div>

	
	</div>
	<script>
function friends(){
	document.getElementById('restoranProfil').style.display = 'none';
	document.getElementById('glavniDiv').style.display = 'block';
	var x = document.cookie;
	var delovi = x.split("=");
	var email = delovi[1];
	$.ajax({ 
        type: 'GET',
        url: 'profile/svimojiprijateljibisurirasuti',
        dataType: 'json',
        data: {email : email},
		 success: function(data){
        			console.log(data);
        			$('#desniDiv').html('<h3><i>Prijatelji</i></h3><br><div><input name="staTrazim" type="text" placeholder="Traži prijatelje"><input type="button" onclick="return dajPrijateljeTrazi()" value="Traži"><br><br><table id="skrolable"></table></div>');
        			$('#desniDiv').show();
        			if(data.length>0){
            			for(var i=0;i<data.length;i++){
            				$('#skrolable').append('<tr><td><img src="data:image/jpg;base64,' + data[i].slika + '" style="width:100px;height:100px;" /></td><td><h3>'+data[i].ime+'&nbsp;'+ data[i].prezime+'</h3></td><td><input type="button" id='+i+' onclick="return ukloniPrijatelja(\''+data[i].email+'\',\''+i+'\')" value="Obriši prijatelja" /></td></tr><tr><td><br><br></td></tr>');
            			}	
            			}else{
            				$('#skrolable').html('<h3>Ništa nije pronađeno</h3>');
                    		
            			}
		 }
	});
}

function dajPrijateljeTrazi(){
	document.getElementById('restoranProfil').style.display = 'none';
	document.getElementById('glavniDiv').style.display = 'block';
	var x = document.cookie;
	var delovi = x.split("=");
	var email = delovi[1];
	
	var polje = document.getElementsByName('staTrazim');
	var kogaTrazim = polje[0].value;
	
	$('#skrolable').html('');
	
	if(kogaTrazim == ""){
		alert("Morate uneti nešto u pretragu!");
	}
	$.ajax({ 
        type: 'GET',
        url: 'profile/trazi',
        dataType: 'json',
        data: {kogaTrazim : kogaTrazim, email : email },
		 success: function(data){
        			console.log(data);
        			if(data.length>0){
        			for(var i=0;i<data.length;i++){
        				$('#skrolable').append('<tr><td><img src="data:image/jpg;base64,' + data[i].slika + '" style="width:100px;height:100px;" /></td><td><h3>'+data[i].ime+'&nbsp;'+ data[i].prezime+'</h3></td><td><input type="button" id='+i+' onclick="return dodajPrijatelja(\''+data[i].email+'\',\''+i+'\')" value="Dodaj prijatelja" /></td></tr><tr><td><br><br></td></tr>');
        			}	
        			}else{
        				$('#skrolable').html('<h3>Ništa nije pronađeno!</h3>');
                		
        			}
		 }
	});
	
}

function dodajPrijatelja(email,broj){
	document.getElementById('restoranProfil').style.display = 'none';
	document.getElementById('glavniDiv').style.display = 'block';
	var x = document.cookie;
	var delovi = x.split("=");
	var JAemail = delovi[1];
	
	
	$.ajax({ 
        type: 'GET',
        url: 'profile/dodajPrijatelja',
        dataType: 'json',
        data: {mojEmail : JAemail, prijateljevEmail : email},
        complete: function(data){
        			console.log(data);
        			alert("Uspešno dodat prijatelj!");
        			$('#'+broj+'').attr("disabled", true);
		 }
	});
}

function notifikacija(){
	document.getElementById('restoranProfil').style.display = 'none';
	document.getElementById('glavniDiv').style.display = 'block';
	var x = document.cookie;
	var delovi = x.split("=");
	var email = delovi[1];
	
	$('#desniDiv').html("");
	
	$.ajax({ 
        type: 'GET',
        url: 'profile/dajLjude',
        dataType: 'json',
        data: {email : email},
		 success: function(data){
        			console.log(data);
        			if(data.length>0){
        				$('#glavniDiv').show();
        				$('#leviDiv').hide();
        				document.getElementById("helloHeder").innerHTML = "";
            			for(var i=0;i<data.length;i++){
            				$('#desniDiv').append('<tr><td><img src="data:image/jpg;base64,' + data[i].slika + '" style="width:100px;height:100px;" /></td><td><h3>'+data[i].ime+'&nbsp;'+ data[i].prezime+'&nbsp;&nbsp;</h3></td><td><input type="button" onclick="return prihvatiPrijatelja(\''+data[i].email+'\')" value="Prihvati prijatelja" />&nbsp;</td><td><input type="button" onclick="return odbaciPrijatelja(\''+data[i].email+'\')" value="Odbaci" /></td></tr><tr><td><br><br></td></tr>');
            				$('#desniDiv').show();
            			}	
            			}else{
            				$('#desniDiv').html('<h3>Ništa nije pronađeno!</h3>');
                    		
            			}	
		 }
	});
}

function odbaciPrijatelja(emailKogPrijatelja){
	document.getElementById('restoranProfil').style.display = 'none';
	document.getElementById('glavniDiv').style.display = 'block';
	var x = document.cookie;
	var delovi = x.split("=");
	var email = delovi[1];
	
	$.ajax({ 
        type: 'GET',
        url: 'profile/odbaciPrijatelja',
        dataType: 'json',
        data: {email : email, kogaOdbacujem : emailKogPrijatelja},
        complete: function(data){
        			console.log(data);
        			alert("Zahtev za prijateljstvo odbijen!");	
        			location.reload();
		 }
	});
}

function  prihvatiPrijatelja(email) {
	document.getElementById('restoranProfil').style.display = 'none';
	document.getElementById('glavniDiv').style.display = 'block';
	var x = document.cookie;
	var delovi = x.split("=");
	var mojEmail = delovi[1];
	
	$.ajax({ 
        type: 'GET',
        url: 'profile/prihvatiPrijatelja',
        dataType: 'json',
        data: {mojEmail : mojEmail, kogaDodajem : email},
        complete: function(data){
        			console.log(data);
        			alert("Zahtev za prijateljstvo prihvaćen!");	
        			location.reload();
		 }
	});
}

function ukloniPrijatelja(email,broj){
	document.getElementById('restoranProfil').style.display = 'none';
	document.getElementById('glavniDiv').style.display = 'block';
	
	var x = document.cookie;
	var delovi = x.split("=");
	var Jemail = delovi[1];
	
	$.ajax({ 
        type: 'GET',
        url: 'profile/odbaciPrijatelja',
        dataType: 'json',
        data: {email : Jemail, kogaOdbacujem : email},
        complete: function(data){
        			console.log(data);
        			alert("Prijatelj uspešno uklonjen!");	
        			$('#'+broj+'').attr("disabled", true);
		 }
	});
	
}

function pocetnaFrends(){
	document.getElementById('restoranProfil').style.display = 'none';
	document.getElementById('glavniDiv').style.display = 'block';
var x = document.cookie;
var delovi = x.split("=");
var email = delovi[1];

$.ajax({ 
    type: 'GET',
    url: 'profile/svimojiprijateljibisurirasuti',
    dataType: 'json',
    data: {email : email},
	 success: function(data){
    			console.log(data);
    			$('#desniDiv').html('<h3><i>Prijatelji</i></h3><br><div><input name="staTrazim" type="text" placeholder="Traži prijatelje"><input type="button" onclick="return dajPrijateljeTrazi()" value="Traži"><br><br><a onclick="sortPoImenu()" href="#" >Sortiraj po imenu &nbsp;</a><a href="#" onclick="sortPoPrezimenu()" > Sortiraj po prezimenu</a><br><br><table  id="skrolable"></table></div>');
    			$('#desniDiv').show();
    			$('#glavniDiv').show();
				$('#leviDiv').hide();
				document.getElementById("helloHeder").innerHTML = "";
    			if(data.length>0){
    				document.getElementById("helloHeder").innerHTML = "";
        			for(var i=0;i<data.length;i++){
        				$('#skrolable').append('<tr><td><img src="data:image/jpg;base64,' + data[i].slika + '" style="width:100px;height:100px;" /></td><td><h3>'+data[i].ime+'&nbsp;'+ data[i].prezime+'</h3></td><td><input type="button" id='+i+' onclick="return ukloniPrijatelja(\''+data[i].email+'\',\''+i+'\')" value="Ukloni prijatelja" /></td></tr><tr><td><br><br></td></tr>');
        			}	
        			}else{
        				$('#skrolable').html('<h3>Ništa nije pronađeno!</h3>');
                		
        			}
	 }
});
}

function sortPoImenu(){
	document.getElementById('restoranProfil').style.display = 'none';
	document.getElementById('glavniDiv').style.display = 'block';
	var x = document.cookie;
	var delovi = x.split("=");
	var email = delovi[1];

	$.ajax({ 
	    type: 'GET',
	    url: 'profile/sortPoImenu',
	    dataType: 'json',
	    data: {email : email},
		 success: function(data){
	    			console.log(data);
	    			$('#desniDiv').html('<h3><i>Prijatelji</i></h3><br><div><input name="staTrazim" type="text" placeholder="Traži prijatelje"><input type="button" onclick="return dajPrijateljeTrazi()" value="Traži"><br><br><a onclick="sortPoImenu()" href="#" >Sortiraj po imenu &nbsp;</a><a href="#" onclick="sortPoPrezimenu()" > Sortiraj po prezimenu</a><br><br><table  id="skrolable"></table></div>');
	    			$('#desniDiv').show();
	    			if(data.length>0){
	    				$('#glavniDiv').show();
	    				$('#leviDiv').hide();
	    				document.getElementById("helloHeder").innerHTML = "";
	        			for(var i=0;i<data.length;i++){
	        				$('#skrolable').append('<tr><td><img src="data:image/jpg;base64,' + data[i].slika + '" style="width:100px;height:100px;" /></td><td><h3>'+data[i].ime+'&nbsp;'+ data[i].prezime+'</h3></td><td><input type="button" id='+i+' onclick="return ukloniPrijatelja(\''+data[i].email+'\',\''+i+'\')" value="Ukloni prijatelja" /></td></tr><tr><td><br><br></td></tr>');
	        			}	
	        			}else{
	        				$('#skrolable').html('<h3>Ništa nije pronađeno!</h3>');
	                		
	        			}
		 }
	});
	}
	
	function sortPoPrezimenu(){
		document.getElementById('restoranProfil').style.display = 'none';
		document.getElementById('glavniDiv').style.display = 'block';
		var x = document.cookie;
		var delovi = x.split("=");
		var email = delovi[1];

		$.ajax({ 
		    type: 'GET',
		    url: 'profile/sortPoPrezimenu',
		    dataType: 'json',
		    data: {email : email},
			 success: function(data){
		    			console.log(data);
		    			$('#desniDiv').html('<h3><i>Prijatelji</i></h3><br><div><input name="staTrazim" type="text" placeholder="Traži prijatelje"><input type="button" onclick="return dajPrijateljeTrazi()" value="Traži"><br><br><a onclick="sortPoImenu()" href="#" >Sortiraj po imenu &nbsp;</a><a href="#" onclick="sortPoPrezimenu()" > Sortiraj po prezimenu</a><br><br><table  id="skrolable"></table></div>');
		    			$('#desniDiv').show();
		    			if(data.length>0){
		    				$('#glavniDiv').show();
		    				$('#leviDiv').hide();
		    				document.getElementById("helloHeder").innerHTML = "";
		        			for(var i=0;i<data.length;i++){
		        				$('#skrolable').append('<tr><td><img src="data:image/jpg;base64,' + data[i].slika + '" style="width:100px;height:100px;" /></td><td><h3>'+data[i].ime+'&nbsp;'+ data[i].prezime+'</h3></td><td><input type="button" id='+i+' onclick="return ukloniPrijatelja(\''+data[i].email+'\',\''+i+'\')" value="Ukloni prijatelja" /></td></tr><tr><td><br><br></td></tr>');
		        			}	
		        			}else{
		        				$('#skrolable').html('<h3>Ništa nije pronađeno!</h3>');
		                		
		        			}
			 }
		});
	}

	function sviRestorani(){
		document.getElementById('restoranProfil').style.display = 'none';
		document.getElementById('glavniDiv').style.display = 'block';
		var cars = new Array();
		var imaga = false;
		$.ajax({ 
		    type: 'GET',
		    url: 'restoran/dobaviRestorane',
		    dataType: 'json',
			 success: function(data){
		    			console.log(data);
		    			$('#desniDiv').html('<h3><i>Svi restorani</i></h3><br><div><input name="staTrazimR" type="text" placeholder="Traži restoran"><input type="button" onclick="return dajRestoraneTrazi()" value="Traži"><br><br><p>Traži po vrsti: <select onchange="traziPoVrsti()" id="vrstaRestorana"></select></p><a onclick="sortPoImenuRestorane()" href="#" >Sortiraj po imenu &nbsp;</a><br><br><a onclick="sortPoUdaljenosti()" href="#" >Sortiraj udaljenosti &nbsp;</a><br><br><table  id="skrolable"></table></div>');
		    			$('#desniDiv').show();
		    			if(data.length>0){
		    				$('#glavniDiv').show();
		    				$('#leviDiv').hide();
		    				
		    				
		    				document.getElementById("helloHeder").innerHTML = "";
		        			for(var i=0;i<data.length;i++){
		        				$('#skrolable').append('<tr><td><img id="slikaRestImg" src="/slike/restorani/restoran.jpg" style="width:250px;height:100"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><h3><a onclick="dajStranicuRestorana(\''+data[i].id+'\')" href="#">'+data[i].naziv+'</a></h3><h6>'+ data[i].opis+'</h6></td><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="button" id='+i+' onclick="return rezervisemRestoran(\''+data[i].id+'\',\''+i+'\')" value="Rezerviši" /></td></tr><tr><td><br><br></td></tr>');
		        			
		        				if(cars.length < 1){
			    					cars.push(String(data[0].tip));
			    					
			    				}else{
		        				
		        						for(var w =0;w<cars.length;w++){
		        							if(cars[w] === String(data[i].tip)){
		        								imaga = true;
		        							}
		        						}
		        						
		        						if(imaga === false){
		        							imaga = false;
		        							cars.push(String(data[i].tip));
		        						}
			    				}
		        				console.log(data[i].slika);
		        				var putanjaSlike = "../../../slike/restorani/"+data[i].slika;
			    				$("#slikaRestImg").attr("src", putanjaSlike);
		        			}	
		        			
		        			}else{
		        				$('#skrolable').html('<h3>Ništa nije pronađeno!</h3>');
		                		
		        			}
		    			$('#vrstaRestorana').append($("<option></option>").attr("value","izaberi").text("Izaberi tip za selekciju po vrsti"));
		    			for(var p=0;p<cars.length;p++){
       					 $('#vrstaRestorana').append($("<option></option>").attr("value",cars[p]).text(cars[p])); 
       					
       				}
			 }
		});
	}
	
	function dajStranicuRestorana(idRestorana){
		document.getElementById('restoranProfil').style.display = 'block';
		document.getElementById('glavniDiv').style.display = 'none';
		
		$.ajax({	     
			type: 'GET',
			url: 'restoran/dajRestoranSaId', 
			dataType: 'JSON',
	        data: {id : idRestorana},
	        success: function(data){
	 			console.log(data);
	 			if(data != null){
	 				upisiPodatke(data);
	 				$("#logo").text(data.naziv);
	 				$("#opis").text(data.opis);
	 				$("#adrTD").html(data.adresa);
	 				$("#gradTD").html(data.grad);
	 				$("#telTD").html(data.telefon);
	 				$("#emailTD").html(data.email);
	 				$("#tipTD").html(data.tip);
	 				$("#radnoVremeTD").text(data.vremeOD + ' -- ' + data.vremeDO);
	 				var putanjaSlike = "../../../slike/restorani/"+data.slika;
	 				$("#slikaRestImg").attr("src", putanjaSlike);
	 				//console.data
	 				setMap(data.adresa + ', ' + data.grad + ', Srbija');
	 				
	 				//restoran = data;
	 			}
	        }
		});
	}
	
	function upisiPodatke(data) {
		$("#nazivRestorana").text(data.naziv);
		$("#nazivRest").val(data.naziv);
		$("#opisRest").val(data.opis);
		$("#telRest").val(data.telefon);
		$("#emailRest").val(data.email);
		$("#adrRest").val(data.adresa);
		$("#gradRest").val(data.grad);
		$("#tipRest").val(data.tip);
		$("#vremeODRest").val(data.vremeOD);
		$("#vremeDORest").val(data.vremeDO);
		$("#idRestorana").text(data.id);
		$("#valutaRestorana").text(data.valuta);
	}
	
	function setMap(address){
		var geocoder = new google.maps.Geocoder();

		geocoder.geocode({'address': address}, function(results,status){
		
		if (status == google.maps.GeocoderStatus.OK){
			var location = results[0].geometry.location;
			var map_options = {
					center :  location,
					zoom : 14
			}
			
			var addressMap = new google.maps.Map(document.getElementById('dajmapumesto'),map_options);
			
			var marker = new google.maps.Marker({
				position: location,
				map: addressMap
			})
		}
	});
	}
	
	function sortPoImenuRestorane(){
		document.getElementById('restoranProfil').style.display = 'none';
		document.getElementById('glavniDiv').style.display = 'block';
		$.ajax({ 
		    type: 'GET',
		    url: 'restoran/sortirajrestoranepoimenu',
		    dataType: 'json',
			 success: function(data){
				 $('#skrolable').html('');
		    			console.log(data);
		    			$('#desniDiv').html('<h3><i>Svi restorani</i></h3><br><div><input name="staTrazimR" type="text" placeholder="Traži restoran"><input type="button" onclick="return dajRestoraneTrazi()" value="Traži"><br><br><table  id="skrolable"></table></div>');
		    			$('#desniDiv').show();
		    			if(data.length>0){
		    				$('#glavniDiv').show();
		    				$('#leviDiv').hide();
		    				document.getElementById("helloHeder").innerHTML = "";
		        			for(var i=0;i<data.length;i++){
		        				$('#skrolable').append('<tr><td><img id="slikaRestImg" src="/slike/restorani/restoran.jpg" style="width:250px;height:100"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><h3><a href="#">'+data[i].naziv+'</a></h3><h6>'+ data[i].opis+'</h6></td><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="button" id='+i+' onclick="return rezervisemRestoran(\''+data[i].id+'\',\''+i+'\')" value="Rezerviši" /></td></tr><tr><td><br><br></td></tr>');
		        			}	
		        			}else{
		        				$('#skrolable').html('<h3>Ništa nije pronađeno!</h3>');
		                		
		        			}
			 }
		});
	}
	
	function dajRestoraneTrazi(){
		document.getElementById('restoranProfil').style.display = 'none';
		document.getElementById('glavniDiv').style.display = 'block';
		var r = document.getElementsByName('staTrazimR');
		var naziv = r[0].value;
		
		if(naziv != ""){
		
		$.ajax({ 
		    type: 'GET',
		    url: 'restoran/trazirestoran',
		    dataType: 'json',
		    data: {tekst : naziv},
			 success: function(data){
				 $('#skrolable').html('');
		    			console.log(data);
		    			$('#desniDiv').html('<h3><i>Svi restorani</i></h3><br><div><input name="staTrazimR" type="text" placeholder="Traži restorane"><input type="button" onclick="return dajRestoraneTrazi()" value="Traži"><br><br><br><table  id="skrolable"></table></div>');
		    			$('#desniDiv').show();
		    			if(data.length>0){
		    				$('#glavniDiv').show();
		    				$('#leviDiv').hide();
		    				document.getElementById("helloHeder").innerHTML = "";
		        			for(var i=0;i<data.length;i++){
		        				$('#skrolable').append('<tr><td><img id="slikaRestImg" src="/slike/restorani/restoran.jpg" style="width:250px;height:100"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><h3><a href="#">'+data[i].naziv+'</a></h3><h6>'+ data[i].opis+'</h6></td><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="button" id='+i+' onclick="return rezervisemRestoran(\''+data[i].id+'\',\''+i+'\')" value="Rezerviši" /></td></tr><tr><td><br><br></td></tr>');
		        			}
		        			}else{
		        				$('#skrolable').html('<h3>Ništa nije pronađeno!</h3>');
		                		
		        			}
			 }
		});
		}
	}
	
	function traziPoVrsti(){
		document.getElementById('restoranProfil').style.display = 'none';
		document.getElementById('glavniDiv').style.display = 'block';
		var i = document.getElementById('vrstaRestorana');
		var selektovanog = i.options[i.selectedIndex].value;
		
		if(selektovanog === "izaberi"){
			return;
		}else{
			$.ajax({ 
			    type: 'GET',
			    url: 'restoran/dobaviRestorane',
			    dataType: 'json',
				 success: function(data){
			    			console.log(data);
			    			$('#desniDiv').html('<h3><i>Svi restorani</i></h3><br><div><input name="staTrazimR" type="text" placeholder="Traži restoran"><input type="button" onclick="return dajRestoraneTrazi()" value="Traži"><br><br><br><table  id="skrolable"></table></div>');
			    			$('#desniDiv').show();
			    			if(data.length>0){
			    				$('#glavniDiv').show();
			    				$('#leviDiv').hide();
			    				
			    				document.getElementById("helloHeder").innerHTML = "";
			        			for(var i=0;i<data.length;i++){
			        				if(String(data[i].tip) === selektovanog)
			        					$('#skrolable').append('<tr><td><img id="slikaRestImg" src="/slike/restorani/restoran.jpg" style="width:250px;height:100"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><h3><a href="#">'+data[i].naziv+'</a></h3><h6>'+ data[i].opis+'</h6></td><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="button" id='+i+' onclick="return rezervisemRestoran(\''+data[i].id+'\',\''+i+'\')" value="Rezerviši" /></td></tr><tr><td><br><br></td></tr>');
				        			}
			        		}else{
			        			$('#skrolable').html('<h3>Ništa nije pronađeno!</h3>');
			                		
			        		}
			    			
			        	}
			   });
	}
	}

	
	function sortPoUdaljenosti(){
		
		document.getElementById('restoranProfil').style.display = 'none';
		document.getElementById('glavniDiv').style.display = 'block';
		
		
			$.ajax({ 
			    type: 'GET',
			    url: 'restoran/sortPoUdaljenosti',
			    dataType: 'json',
			    data: {grad : grad},
				 success: function(data){
					 console.log(data);
					 $('#skrolable').html('');
			    			console.log(data);
			    			$('#desniDiv').html('<h3><i>Svi restorani</i></h3><br><div><input name="staTrazimR" type="text" placeholder="Traži restoran"><input type="button" onclick="return dajRestoraneTrazi()" value="Traži"><br><br><table  id="skrolable"></table></div>');
			    			$('#desniDiv').show();
			    			if(data.length>0){
			    				$('#glavniDiv').show();
			    				$('#leviDiv').hide();
			    				document.getElementById("helloHeder").innerHTML = "";
			        			for(var i=0;i<data.length;i++){
			        				$('#skrolable').append('<tr><td><img id="slikaRestImg" src="/slike/restorani/restoran.jpg" style="width:250px;height:100"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><h3><a href="#">'+data[i].naziv+'</a></h3><h6>'+ data[i].opis+'</h6></td><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="button" id='+i+' onclick="return rezervisemRestoran(\''+data[i].id+'\',\''+i+'\')" value="Rezerviši" /></td></tr><tr><td><br><br></td></tr>');
			        			}	
			        			}else{
			        				$('#skrolable').html('<h3>Ništa nije pronađeno!</h3>');
			                		
			        			}
				 }
			});
		}
	
			
	
</script>
</body>
</html>